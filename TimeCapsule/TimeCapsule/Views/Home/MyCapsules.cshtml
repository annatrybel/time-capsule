@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model List<TimeCapsule.Models.ViewModels.TimeRemainingViewModel>
@using TimeCapsule.Extensions;

@{
    ViewData["Title"] = "Moje Kapsuły";
}
@section Styles {
    <link rel="stylesheet" href="~/css/MyCapsules.css" />
}

<section class="hero">
    <h1><b>MOJE KAPSUŁY</b></h1>
</section>

<div class="container">
    @if (Model == null || !Model.Any())
    {
        <section class="cta no-capsules-section">
            <div class="no-capsule-box">
                <h2>@Localizer["NoCapsulesMessage"]</h2>
                <a asp-controller="TimeCapsule" asp-action="Step1" class="cta-button">
                    @Localizer["CreateCapsuleNow"]
                </a>
            </div>
        </section>
    }
    else
    {
        <section class="capsules has-capsules-section">
            @foreach (var capsule in Model)
            {
                <div class="capsule-timer-wrapper">
                    <p class="capsule-info">
                        @Localizer["UntilCapsulaOpens"] <strong>@capsule.Title</strong>
                        @if (capsule.CanOpen)
                        {
                            <span class="badge bg-success">@Localizer["ReadyToOpen"]</span>
                        }
                        else
                        {
                            <span>@Localizer["TimeRemaining"]</span>
                        }
                    </p>
                    @if (capsule.CanOpen)
                    {
                        <div class="text-center my-4">
                            <a asp-controller="Capsule" asp-action="Open" asp-route-id="@capsule.Id" class="btn btn-primary btn-lg">
                                <i class="bi bi-unlock me-2"></i>@Localizer["OpenCapsule"]
                            </a>
                        </div>
                    }
                    else
                    {
                        <div class="countdown-circle">
                            <div class="countdown-unit">
                                <div class="countdown-value">@capsule.Years</div>
                                <div class="countdown-label">@Localizer.GetPolishYearForm(capsule.Years)</div>
                            </div>
                            <div class="countdown-unit">
                                <div class="countdown-value">@capsule.Days</div>
                                <div class="countdown-label">@Localizer["Days"]</div>
                            </div>
                            <div class="countdown-unit">
                                <div class="countdown-value">@capsule.Hours</div>
                                <div class="countdown-label">@Localizer.GetPolishHourForm(capsule.Hours)</div>
                            </div>
                            <div class="countdown-unit">
                                <div class="countdown-value">@capsule.Minutes</div>
                                <div class="countdown-label">@Localizer.GetPolishMinuteForm(capsule.Minutes)</div>
                            </div>
                        </div>
                    }
                </div>
            }

            <div class="text-center mt-4">
                <a asp-controller="TimeCapsule" asp-action="Step1" class="cta-button-capsules">
                    @Localizer["CreateNewCapsule"]
                </a>
            </div>
        </section>
    }
</div>


